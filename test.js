let debtor_list = [{"contact":"Абдулазизов Акбаршох Алабердиевич","datePatent":"10.03.2021","dateCheck":"10.02.2021","days":13,"subdivision":"Оллила"},{"contact":"Абдулакимов Фаррух Абдулаким Угли","datePatent":"01.10.2021","dateCheck":"01.02.2021","days":4,"subdivision":"Окна Форте"},{"contact":"Атамуродов Шухрат Равшанович","datePatent":"01.04.2021","dateCheck":"01.02.2021","days":4,"subdivision":"Финфлекс"},{"contact":"Бабаназаров Фарход Халбаевич","datePatent":"01.09.2021","dateCheck":"02.02.2021","days":5,"subdivision":"Подольск"},{"contact":"Баяков Махмуджон Каландарович","datePatent":"10.11.2021","dateCheck":"10.02.2021","days":13,"subdivision":"ЛД-ПРИНТ"},{"contact":"Бобоев Сафармад Авалбоевич","datePatent":"06.04.2021","dateCheck":"06.02.2021","days":9,"subdivision":"Фильтровальные материалы"},{"contact":"Бобомуродов Хамидулло Сайпиллоевич","datePatent":"05.10.2021","dateCheck":"05.02.2021","days":8,"subdivision":"Камышовая 38"},{"contact":"Болтабоев Муроджон Икромджон Угли","datePatent":"06.04.2021","dateCheck":"06.02.2021","days":9,"subdivision":"Эдельвейс"},{"contact":"Гуламов Хайриддин Тагаевич","datePatent":"03.04.2021","dateCheck":"03.02.2021","days":6,"subdivision":"Окна Форте"},{"contact":"Гулов Джалолидин Рахмоналиевич","datePatent":"02.11.2021","dateCheck":"02.02.2021","days":5,"subdivision":"Окна Форте"},{"contact":"Додожонов Ахтамджон Акрамжонович","datePatent":"08.03.2021","dateCheck":"08.02.2021","days":11,"subdivision":"ЛД-ПРИНТ"},{"contact":"Журабоев Салохиддин Сирожиддин Угли","datePatent":"08.09.2021","dateCheck":"08.02.2021","days":11,"subdivision":"Подольск"},{"contact":"Иброхимов Элдор Бахром Угли","datePatent":"04.10.2021","dateCheck":"04.02.2021","days":7,"subdivision":"Фрегат"},{"contact":"Каримова Турсунджон Исроиловна","datePatent":"05.10.2021","dateCheck":"05.02.2021","days":8,"subdivision":"ЛВР АС"},{"contact":"Мавлянова Дилнавоз Мехридиновна","datePatent":"02.09.2021","dateCheck":"02.02.2021","days":5,"subdivision":"ЛВР АС"},{"contact":"Мамаджонов Дониёр Махаматалиевич","datePatent":"30.11.2021","dateCheck":"31.01.2021","days":3,"subdivision":"Арч Групп"},{"contact":"Мардонов Муминджон Зокирович","datePatent":"08.10.2021","dateCheck":"08.02.2021","days":11,"subdivision":"Эдельвейс"},{"contact":"Маткаримова Саида Кушназаровна","datePatent":"07.12.2021","dateCheck":"07.02.2021","days":10,"subdivision":"ЛД-ПРИНТ"},{"contact":"Мирзарахимов Музаффар Бегмурадович","datePatent":"04.05.2021","dateCheck":"04.02.2021","days":7,"subdivision":"ЛД-ПРИНТ"},{"contact":"Муродов Сорбон Юсуфович","datePatent":"04.05.2021","dateCheck":"04.02.2021","days":7,"subdivision":"ЛД-ПРИНТ"},{"contact":"Наджимова Гулбахор Одиловна","datePatent":"06.09.2021","dateCheck":"06.02.2021","days":9,"subdivision":"Финфлекс"},{"contact":"Раджабова Зарнигор Шавкатовна","datePatent":"04.10.2021","dateCheck":"04.02.2021","days":7,"subdivision":"Фрегат"},{"contact":"Расулов Махмадюсуф Нормуротович","datePatent":"30.03.2021","dateCheck":"30.01.2021","days":2,"subdivision":"Окна Форте"},{"contact":"Ризаев Анвар Нормахматович","datePatent":"05.08.2021","dateCheck":"05.02.2021","days":8,"subdivision":"Финфлекс"},{"contact":"Рузиев Алишер Зиёдуллоевич","datePatent":"31.03.2021","dateCheck":"31.01.2021","days":3,"subdivision":"Чабыкин ИП"},{"contact":"Сададинова Муборак Шаназаровна","datePatent":"06.06.2021","dateCheck":"06.02.2021","days":9,"subdivision":"ЛВР АС"},{"contact":"Саттарова Мадина Бахронкуловна","datePatent":"07.09.2021","dateCheck":"07.02.2021","days":10,"subdivision":"ЛД-ПРИНТ"},{"contact":"Собирджонов Зиёвиддин Содикджон Угли","datePatent":"07.04.2021","dateCheck":"07.02.2021","days":10,"subdivision":"Эдельвейс"},{"contact":"Собиров Каримжон Рашиджон Угли","datePatent":"11.11.2021","dateCheck":"11.02.2021","days":14,"subdivision":"Подольск"},{"contact":"Толибов Абдукахор Абдуразокович","datePatent":"02.12.2021","dateCheck":"02.02.2021","days":5,"subdivision":"Окна Форте"},{"contact":"Туйчиев Бехзодбек Насибджон Угли","datePatent":"07.04.2021","dateCheck":"07.02.2021","days":10,"subdivision":"Эдельвейс"},{"contact":"Тургунов Дилшод Баиржонович","datePatent":"11.08.2021","dateCheck":"11.02.2021","days":14,"subdivision":"Мистер ЛиС"},{"contact":"Тухтасинов Абдусаттор Бахтиёржон Угли","datePatent":"10.08.2021","dateCheck":"10.02.2021","days":13,"subdivision":"Подольск"},{"contact":"Худайкулов Бектош Шухратович","datePatent":"11.05.2021","dateCheck":"11.02.2021","days":14,"subdivision":"Дегтярь ИП"},{"contact":"Эшметов Руслон Куролбоевич","datePatent":"08.07.2021","dateCheck":"08.02.2021","days":11,"subdivision":"Окна Форте"},{"contact":"Юнусов Хабибуло Эгамбердиевич","datePatent":"30.07.2021","dateCheck":"31.01.2021","days":3,"subdivision":"Кошелев ИП"},{"contact":"Яров Икромджон Гафарович","datePatent":"07.09.2021","dateCheck":"07.02.2021","days":10,"subdivision":"Бетокон"},{"contact":"Атоева Заррина Аъллоевна","datePatent":"11.04.2021","dateCheck":"11.02.2021","days":14,"subdivision":"ПерсоналСервис"},{"contact":"Джуманиязова Салтанат Отаджановна","datePatent":"09.04.2021","dateCheck":"09.02.2021","days":12,"subdivision":"ПерсоналСервис"},{"contact":"Махмадуллоев Асадулло Махмадуллоевич","datePatent":"10.03.2021","dateCheck":"10.02.2021","days":13,"subdivision":"ПерсоналСервис"},{"contact":"Тагаев Ташмухаммад Ташмуратович","datePatent":"09.11.2021","dateCheck":"09.02.2021","days":12,"subdivision":"Оллила"}];
let negative_list = [
    {
        contact: 'Абдухалилов Сардор Равшан',
        dateCheck: '31.12.2020',
        days: -13,
        subdivision: 'Чабыкин ИП'
    },
    {
        contact: 'Азизов Ахлиддин Валиевич',
        dateCheck: '01.01.2021',
        days: -12,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Азимов Махаммаджон Исмоилджон Угли',
        dateCheck: '30.10.2020',
        days: -75,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Азимов Орифджон Одилджон Угли',
        datePatent: '08.11.2020',
        dateCheck: '08.10.2020',
        days: -97,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Алиджонов Хаётбек Кахрамон Угли',
        dateCheck: '07.12.2020',
        days: -37,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Атаджанов Гайрат Аминович',
        dateCheck: '04.01.2021',
        days: -9,
        subdivision: 'ВентКондиционерСервис'
    },
    {
        contact: 'Ахмедов Иброхимжон Солиевич',
        dateCheck: '23.10.2020',
        days: -82,
        subdivision: 'Подольск'
    },
    {
        contact: 'Ачилов Илхом Маруфович',
        dateCheck: '12.01.2021',
        days: -1,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Бахриев Собирджон Сохибович',
        dateCheck: '07.12.2020',
        days: -37,
        subdivision: 'Трайнет Ольгино'
    },
    {
        contact: 'Бобоев Сафармад Авалбоевич',
        dateCheck: '06.01.2021',
        days: -7,
        subdivision: 'Фильтровальные материалы'
    },
    {
        contact: 'Гулов Джалолидин Рахмоналиевич',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Джумакулова Азиза Хамро Кизи',
        dateCheck: '26.11.2020',
        days: -48,
        subdivision: 'Фрегат'
    },
    {
        contact: 'Джумамуратов Джавланбек Алимбаевич',
        dateCheck: '03.01.2021',
        days: -10,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Джуматов Мансур Махмудович',
        dateCheck: '14.12.2020',
        days: -30,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Ибрагимов Комилджон Шухратджонович',
        dateCheck: '28.10.2020',
        days: -77,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Икромов Давлатджон Хайрулло Угли',
        dateCheck: '22.11.2020',
        days: -52,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Каримов Сарварбек Саттор Угли',
        dateCheck: '13.11.2020',
        days: -61,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Кенджаева Шоира Сапарбоевна',
        dateCheck: '27.12.2020',
        days: -17,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Косимджонов Абдухошим Азамджон Угли',
        dateCheck: '09.12.2020',
        days: -35,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Мардонов Муминджон Зокирович',
        dateCheck: '08.01.2021',
        days: -5,
        subdivision: 'Эдельвейс'
    },
    {
        contact: 'Маткаримова Саида Кушназаровна',
        dateCheck: '07.01.2021',
        days: -6,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Махмадалиев Мухаммадали Ятимович',
        dateCheck: '07.01.2021',
        days: -6,
        subdivision: 'Полячков ИП'
    },
    {
        contact: 'Махматов Гофир Бекмурод Угли',
        dateCheck: '13.12.2020',
        days: -31,
        subdivision: 'ВентКондиционерСервис'
    },
    {
        contact: 'Махмудов Неъматилло Рахматилло Угли',
        datePatent: '17.12.2020',
        dateCheck: '17.11.2020',
        days: -57,
        subdivision: 'Подольск'
    },
    {
        contact: 'Мирзарахимов Музаффар Бегмурадович',
        dateCheck: '04.01.2021',
        days: -9,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Мусинов Фазлиддин Фахриддин Угли',
        dateCheck: '16.10.2020',
        days: -89,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Мусурмонов Зухриддин Зафарович',
        dateCheck: '06.01.2021',
        days: -7,
        subdivision: 'СоюзХимИнвест'
    },
    {
        contact: 'Негматова Гуландон Анваровна',
        dateCheck: '06.01.2021',
        days: -7,
        subdivision: 'Фрегат'
    },
    {
        contact: 'Нематов Фаррухджон Шарифджонович',
        dateCheck: '03.01.2021',
        days: -10,
        subdivision: 'РЖЕВКА-ХЛЕБ'
    },
    {
        contact: 'Расулов Мухаммадсодик Махматджонович',
        dateCheck: '09.01.2021',
        days: -4,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Саидкамолов Шерзод Абдикахорович',
        dateCheck: '21.11.2020',
        days: -53,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Сатторов Наим Валиевич',
        dateCheck: '31.12.2020',
        days: -13,
        subdivision: 'Авиатор-2'
    },
    {
        contact: 'Собитов Отабек Алижон Угли',
        dateCheck: '01.11.2020',
        days: -73,
        subdivision: 'Подольск'
    },
    {
        contact: 'Солиева Нозимахон Хамидулло Кизи',
        dateCheck: '12.01.2021',
        days: -1,
        subdivision: 'СоюзХимИнвест'
    },
    {
        contact: 'Сохибов Муродил Мухаммадали Угли',
        dateCheck: '27.12.2020',
        days: -17,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Толибов Абдукахор Абдуразокович',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Тураев Ботир Суюнович',
        dateCheck: '05.01.2021',
        days: -8,
        subdivision: 'РЖЕВКА-ХЛЕБ'
    },
    {
        contact: 'Тухтамишев Бехзод Шавкатович',
        datePatent: '17.12.2020',
        dateCheck: '17.12.2020',
        days: -27,
        subdivision: 'Оборудование для торговли'
    },
    {
        contact: 'Умурзаков Хасанбой Арапжон Угли',
        dateCheck: '15.11.2020',
        days: -59,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Уринбаев Азизбек Кадамбой Угли',
        dateCheck: '09.12.2020',
        days: -35,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Хабибуллаев Отабек Кудратулло Угли',
        dateCheck: '07.10.2020',
        days: -98,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Хакимов Сохибжон Соибжон Угли',
        dateCheck: '23.10.2020',
        days: -82,
        subdivision: 'Подольск'
    },
    {
        contact: 'Халилова Дилдорахон Баходировна',
        dateCheck: '04.01.2021',
        days: -9,
        subdivision: 'ЛВР АС'
    },
    {
        contact: 'Халматджанов Дилмуратджон',
        dateCheck: '25.11.2020',
        days: -49,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Хамидов Умид Хусанбоевич',
        dateCheck: '26.11.2020',
        days: -48,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Хасанбоев Амирулло Омонжон Угли',
        datePatent: '13.01.2021',
        dateCheck: '13.11.2020',
        days: -61,
        subdivision: 'Подольск'
    },
    {
        contact: 'Хасанов Махмуд Лолаевич',
        dateCheck: '12.01.2021',
        days: -1,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Хатамов Сардорбек Азимджон Угли',
        dateCheck: '06.10.2020',
        days: -99,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Худоёров Сардор Рустам Угли',
        dateCheck: '19.11.2020',
        days: -55,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Шаймуродов Ислом Чориёр Угли',
        dateCheck: '09.11.2020',
        days: -65,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эркаева Мухиба Мухторовна',
        dateCheck: '20.10.2020',
        days: -85,
        subdivision: 'РЖЕВКА-ХЛЕБ'
    },
    {
        contact: 'Эркаева Шакаржон Шоназар Кизи',
        dateCheck: '18.11.2020',
        days: -56,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эшкурбонов Хуррам Норбоевич',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эшметов Руслон Куролбоевич',
        dateCheck: '08.01.2021',
        days: -5,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эшмуродова Шахноза Бахтиёр Кизи',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'СоюзХимИнвест'
    }
]
let google_sheets_value = [["Арома-Клининг","hr@aroma-cleaning.ru"],["ПерсоналСервис","hr@aroma-cleaning.ru"],["Сапига ИП","hr@aroma-cleaning.ru"],["Шпунюк ИП","hr@aroma-cleaning.ru"],["Оллила","vitaly.k@guestworkers.ru"],["Бочок ИП","arsentevao@forte.su"],["Кизимов ИП","hr@aroma-cleaning.ru"],["Трайнет СПБ","komiljon.ibragimov@mail.ru"],["Подольск","nikolasha-3@mail.ru"],["НПФ Электрик","babelov@mail.ru"],["Центргаз","otdkadr@skand.ru"],["Шипулин ИП","minyaeva.viktoriya@yandex.ru"],["Оллила","vitaly.k@guestworkers.ru"],["Киселёв ИП","minyaeva.viktoriya@yandex.ru"],["Кошелев ИП","minyaeva.viktoriya@yandex.ru"],["Дегтярь ИП","minyaeva.viktoriya@yandex.ru"],["ИП Полячков","zhenchik@yandex.ru"],["Чабыкин ИП","minyaeva.viktoriya@yandex.ru"],["ПЕТРОМЕДЛАБ","komotdekapital@gmail.com"],["НПФ Анлес","ask@anles.ru"],["АрчГрупп","archgroup24@gmail.com"],["Тепловое оборудование","smirnova.o@guestworkers.ru"],["Авиатор-2","helenspb@gmail.com"],["ЛД-ПРИНТ","smokrikova@ldprint.ru"],["СоюзХимИнвест","hr@aroma-cleaning.ru"],["Эдельвейс","ilyosbek.xamrakulov@mail.ru"],["ВентКондиционерСервис","ventkonservice@mail.ru"],["Финфлекс","elena@finfleks.ru"],["Оборудование для торговли","odt@odt.ru"],["ПромДетальМаш","evd01@yandex.ru"],["ПТ ГРУПП","kudrina@trak-on.ru"],["Бетокон","shkelev@bk.ru"],["Браво","lucysarc@mail.ru"],["ЛВР СК","ep2@lvr-service.ru"],["Окна Форте","arsentevao@forte.su"],["ЛВР АС","ep2@lvr-service.ru"],["Вентура","kudrina@trak-on.ru"],["Мистер ЛиС","lisbrewbuh@mail.ru, lelikpo@yandex.ru"],["Трайнет Ольгино","avk0570@yandex.ru"],["Фрегат","19731703@mail.ru"],["Рускодом Мебель","ruskodom@mail.ru"],["Лайф","ilyosbek.xamrakulov@mail.ru"],["РЖЕВКА-ХЛЕБ","smirnova.o@guestworkers.ru"],["Камышовая 38","helenspb@gmail.com"],["Ультра-Сервис","komiljon.ibragimov@mail.ru"],["Фильтровальные материалы","doroshencoo@mail.ru"]];
let email_content = [];
let email_address = [];
let test_list = [
    {
        contact: 'Алиджонов Лочинбек Ахмаджон Угли',
        datePatent: '14.02.2021',
        dateCheck: '14.02.2021',
        days: 32,
        subdivision: 'Арч Групп'
    },
    {
        contact: 'Додарджонов Мухиддин Хошимджонович',
        datePatent: '08.03.2021',
        dateCheck: '08.03.2021',
        days: 54,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Имомбердиев Тухтасин',
        datePatent: '09.03.2021',
        dateCheck: '09.03.2021',
        days: 55,
        subdivision: 'Оллила'
    },
    {
        contact: 'Кабулова Санобар Абдиджапаровна',
        datePatent: '03.02.2021',
        dateCheck: '03.02.2021',
        days: 21,
        subdivision: 'Браво'
    },
    {
        contact: 'Мухаматкулов Фарход Абдурахмонович',
        datePatent: '28.02.2021',
        dateCheck: '28.02.2021',
        days: 46,
        subdivision: 'ЛВР СК'
    },
    {
        contact: 'Насибджонов Махмуджон Абдумухтор Угли',
        datePatent: '12.02.2021',
        dateCheck: '12.02.2021',
        days: 30,
        subdivision: 'Эдельвейс'
    },
    {
        contact: 'Хайотов Эмомназар Махмадович',
        datePatent: '24.02.2021',
        dateCheck: '24.02.2021',
        days: 42,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Худойкулова Шоиста Рузикуловна',
        datePatent: '02.02.2021',
        dateCheck: '02.02.2021',
        days: 20,
        subdivision: 'ЛД-ПРИНТ'
    }
];


const google_sheets_values_email = [
    ["hr@aroma-cleaning.ru"],
    ["vitaly.k@guestworkers.ru"],
    ["arsentevao@forte.su"],
    ["komiljon.ibragimov@mail.ru"],
    ["nikolasha-3@mail.ru"],
    ["babelov@mail.ru"],
    ["otdkadr@skand.ru"],
    ["minyaeva.viktoriya@yandex.ru"],
    ["zhenchik@yandex.ru"],
    ["komotdekapital@gmail.com"],
    ["ask@anles.ru"],
    ["archgroup24@gmail.com"],
    ["smirnova.o@guestworkers.ru"],
    ["helenspb@gmail.com"],
    ["ilyosbek.xamrakulov@mail.ru"],
    ["ventkonservice@mail.ru"],
    ["elena@finfleks.ru"],
    ["odt@odt.ru"],
    ["evd01@yandex.ru"],
    ["kudrina@trak-on.ru"],
    ["shkelev@bk.ru"],
    ["lucysarc@mail.ru"],
    ["ep2@lvr-service.ru"],
    ["lisbrewbuh@mail.ru"],
    ["avk0570@yandex.ru"],
    ["19731703@mail.ru"],
    ["ruskodom@mail.ru"],
    ["doroshencoo@mail.ru"],
    ["smokrikova@ldprint.ru"]
]

const emailsMap = Object.fromEntries(google_sheets_value);

// Создание массива где присваиваетсяя один электронный адрес для парных подразделений
const a = debtor_list.map(x => ({
    ...x,
    email: emailsMap[x.subdivision]
}));

const b = negative_list.map(x => ({
    ...x,
    email: emailsMap[x.subdivision]
}));
const c = test_list.map(x => ({
    ...x,
    email: emailsMap[x.subdivision]
}));



// Группировка
function groupBy(list, keyGetter) {
    const map = new Map();
    list.forEach((item) => {
        const key = keyGetter(item);
        const collection = map.get(key);
        if (!collection) {
            map.set(key, [item]);
        } else {
            collection.push(item);

        }
    });
    return map;
}


const grouped = groupBy(a, pet => pet.email);
const negativegroup = groupBy(b, pet => pet.email);
const testGroup = groupBy(c, pet => pet.email);

// Создание тела письма
google_sheets_values_email.forEach(e => {
    const cur = grouped.get(e[0]);
    const neg = negativegroup.get(e[0]);
    const test = testGroup.get(e[0]);
    const cur_content = [];
    const neg_content = [];
    const test_content = [];
    if (!cur) {
          console.log(`По почте ${e[0]} никого нет <br />`)
        return
    } else  {
        email_address.push(`${e}`);
        cur_content.push(
            `
    <div style="
    font-size: 15px;
    line-height: 1.5">
    <p style="
    font-size: 18px">Доброе время суток! ${e}</p> <br>

Напоминаем нашим клиентам о необходимости актуализации информации по оплате патентов. <br>
Все сотрудники, у кого не будет актуальных документов будут отстранены, а заработная плата не будет начисляться и выплачиваться. <br>
Убедительна просьба присылать актуальную информацию до 13го (для начисления аванса) и 28го (для начисления заработной платы) чисел каждого месяца.
 <br>
Так же, при необходимости трудоустройства новых сотрудников и предоставлении их документов по электронной почте, просим в теле письма писать следующую фразу: "Просим трудоустроить сотрудника ФИО" с указанием даты трудоустройства. <br>
Ниже представлена таблица с актуальными данными: <br>
    </div>
    <table style="
    text-align: center;
    border-collapse: collapse;
    width: 100%;
    font-size: 13px;
    ">
    <tr style="
    border: 1px solid #000000">
    <td style="
        text-align: left">ФИО сотрудника</td>
    <td> Патент действителен до</td>
<td>Патент оплачен до</td>
<td>Количество дней<div>до истечения оплаты</td>
</tr>
    ${cur.map(c=>`
    <tr style="
    border: 1px solid #000000">
        <td style="
        text-align: left">
        ${c.contact}
        </td>
        <td>${c.datePatent}</td>
        <td>${c.dateCheck}</td>
        <td>${c.days}</td>
    </tr>`).join("")}
    </table>
           `);
        if (neg) {
            neg_content.push(
                `
                <p style="
    color: red;
    font-size: 17px;
    ">Список работников, у которых были просрочены чеки:
    </p>
     <table style="
    text-align: center;
    border-collapse: collapse;
    width: 100%;
    font-size: 13px;
    ">
    <tr style="
    border: 1px solid #000000">
    <td style="
        text-align: left">ФИО сотрудника</td>
<td>Патент оплачен до</td>
<td>Количество дней<div>с момента просрочки</td>
</tr>
     ${neg.map(c=>`
    <tr style="
    border: 1px solid #000000">
        <td style="
        text-align: left">
        ${c.contact}
        </td>
        <td>${c.dateCheck}</td>
        <td>${c.days}</td>
    </tr>`).join("")}
    </table>
                `
            )
        }
        if (test) {
            test_content.push(
                `
                <p style="
    color: red;
    font-size: 17px;
    ">Список работников, которым необходимо переоформить патент</p>
     <table style="
    text-align: center;
    border-collapse: collapse;
    width: 100%;
    font-size: 13px;
    ">
    <tr style="
    border: 1px solid #000000">
    <td style="
        text-align: left">ФИО сотрудника</td>
<td>Патент действителен до</td>
<td>Количество дней<div>до окончания патента</td>
</tr>
      ${test.map(c=>`
    <tr style="
    border: 1px solid #000000">
        <td style="
        text-align: left">
        ${c.contact}
        </td>
        <td>${c.dateCheck}</td>
        <td>${c.days}</td>
    </tr>`).join("")}
    </table>
                `
            )
        }
    }
    const email_list = cur_content + neg_content + test_content;
    email_content.push(email_list)
});

console.log(email_address);
document.write(email_content);
