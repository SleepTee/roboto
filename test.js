let debtor_list = [
    {
        contact: 'Аббосов Сухроб Тулкинович',
        datePatent: '23.12.2021',
        dateCheck: '23.01.2021',
        days: 10,
        subdivision: 'Дегтярь ИП'
    },
    {
        contact: 'Абдуева Рубаба Танрыверди Кызы',
        datePatent: '20.09.2021',
        dateCheck: '20.01.2021',
        days: 7,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Абдукаюмов Хасанбой Бахтиёрович',
        datePatent: '22.12.2021',
        dateCheck: '22.01.2021',
        days: 9,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Абдуллаева Санобар Отаджановна',
        datePatent: '14.12.2021',
        dateCheck: '14.01.2021',
        days: 1,
        subdivision: 'ЛВР СК'
    },
    {
        contact: 'Аллабердиев Аброр Анвар Угли',
        datePatent: '17.12.2021',
        dateCheck: '17.01.2021',
        days: 4,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Бабаджанова Дилфуза Сабировна',
        datePatent: '25.11.2021',
        dateCheck: '25.01.2021',
        days: 12,
        subdivision: 'ЛВР АС'
    },
    {
        contact: 'Бидюк Николай Васильевич',
        datePatent: '14.07.2021',
        dateCheck: '14.01.2021',
        days: 1,
        subdivision: 'НПФ Электрик'
    },
    {
        contact: 'Джабборов Шохрух Собирджон Угли',
        datePatent: '25.08.2021',
        dateCheck: '25.01.2021',
        days: 12,
        subdivision: 'Финфлекс'
    },
    {
        contact: 'Джумаев Юсуфджон Нуритдинович',
        datePatent: '25.02.2021',
        dateCheck: '25.01.2021',
        days: 12,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Додожонов Шариф Акрамжонович',
        datePatent: '25.09.2021',
        dateCheck: '25.01.2021',
        days: 12,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Иброхимов Салохиддин Камолиддин Угли',
        datePatent: '14.10.2021',
        dateCheck: '14.01.2021',
        days: 1,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Исматов Дилшод Ибодуллоевич',
        datePatent: '26.05.2021',
        dateCheck: '26.01.2021',
        days: 13,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Исматов Шахзод Отабек Угли',
        datePatent: '23.12.2021',
        dateCheck: '23.01.2021',
        days: 10,
        subdivision: 'Финфлекс'
    },
    {
        contact: 'Кабулова Зарифа Абдуджапаровна',
        datePatent: '18.11.2021',
        dateCheck: '18.01.2021',
        days: 5,
        subdivision: 'Браво'
    },
    {
        contact: 'Касимов Ислом Касимович',
        datePatent: '23.09.2021',
        dateCheck: '23.01.2021',
        days: 10,
        subdivision: 'Кошелев ИП'
    },
    {
        contact: 'Мамадова Гулсара Розиковна',
        datePatent: '14.12.2021',
        dateCheck: '14.01.2021',
        days: 1,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Мамаюсупов Мамуржон Собир Угли',
        datePatent: '23.12.2021',
        dateCheck: '23.01.2021',
        days: 10,
        subdivision: 'Финфлекс'
    },
    {
        contact: 'Мардонов Зокир Доруевич',
        datePatent: '19.07.2021',
        dateCheck: '19.01.2021',
        days: 6,
        subdivision: 'Эдельвейс'
    },
    {
        contact: 'Мухамадиев Умиджон Рахматулло Угли',
        datePatent: '23.12.2021',
        dateCheck: '23.01.2021',
        days: 10,
        subdivision: 'Финфлекс'
    },
    {
        contact: 'Собирова Замира',
        datePatent: '24.11.2021',
        dateCheck: '24.01.2021',
        days: 11,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Сотволдиев Омаджон Журабек Угли',
        datePatent: '26.08.2021',
        dateCheck: '26.01.2021',
        days: 13,
        subdivision: 'Лайф'
    },
    {
        contact: 'Тохиров Нурбек Олимжон Угли',
        datePatent: '25.09.2021',
        dateCheck: '25.01.2021',
        days: 12,
        subdivision: 'ЛВР АС'
    },
    {
        contact: 'Тухтабаев Абдумутали Турсунович',
        datePatent: '27.12.2021',
        dateCheck: '27.01.2021',
        days: 14,
        subdivision: 'Тепловое Оборудование'
    },
    {
        contact: 'Умбаров Жамшед Аширматович',
        datePatent: '15.07.2021',
        dateCheck: '15.01.2021',
        days: 2,
        subdivision: 'Оллила'
    },
    {
        contact: 'Усмонова Фарохат Усаровна',
        datePatent: '16.09.2021',
        dateCheck: '16.01.2021',
        days: 3,
        subdivision: 'СоюзХимИнвест'
    },
    {
        contact: 'Хамракулов Илёсбек Исмоилович',
        datePatent: '26.08.2021',
        dateCheck: '26.01.2021',
        days: 13,
        subdivision: 'Эдельвейс'
    },
    {
        contact: 'Хасанов Хусанбой Бахтиёр Угли',
        datePatent: '26.02.2021',
        dateCheck: '26.01.2021',
        days: 13,
        subdivision: 'РЖЕВКА-ХЛЕБ'
    },
    {
        contact: 'Хомидов Шерзод Рашидович',
        datePatent: '19.04.2021',
        dateCheck: '19.01.2021',
        days: 6,
        subdivision: 'Бетокон'
    },
    {
        contact: 'Худайбердиева Татьяна Анатольевна',
        datePatent: '21.06.2021',
        dateCheck: '21.01.2021',
        days: 8,
        subdivision: 'СоюзХимИнвест'
    },
    {
        contact: 'Хуррамов Самандар Фахриддин Угли',
        datePatent: '18.11.2021',
        dateCheck: '18.01.2021',
        days: 5,
        subdivision: 'Фрегат'
    },
    {
        contact: 'Шукуров Мирджалол Хосил Угли',
        datePatent: '19.02.2021',
        dateCheck: '19.01.2021',
        days: 6,
        subdivision: 'Рускодом Мебель'
    },
    {
        contact: 'Юлдошева Санобар Абдумуталимовна',
        datePatent: '19.08.2021',
        dateCheck: '19.01.2021',
        days: 6,
        subdivision: 'ЛВР СК'
    },
    {
        contact: 'Якубжонов Акмалжон Касимджонович',
        datePatent: '16.12.2021',
        dateCheck: '16.01.2021',
        days: 3,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Джураева Мафтуна Хакимбоевна',
        datePatent: '20.04.2021',
        dateCheck: '20.01.2021',
        days: 7,
        subdivision: 'Арома-Клининг'
    },
    {
        contact: 'Джураева Хилола Анваровна',
        datePatent: '22.04.2021',
        dateCheck: '22.01.2021',
        days: 9,
        subdivision: 'Арома-Клининг'
    },
    {
        contact: 'Зияев Уктам Эркинович',
        datePatent: '23.08.2021',
        dateCheck: '23.01.2021',
        days: 10,
        subdivision: 'Сапига ИП'
    },
    {
        contact: 'Зияев Фирдавс Уктамович',
        datePatent: '17.06.2021',
        dateCheck: '17.01.2021',
        days: 4,
        subdivision: 'Сапига ИП'
    },
    {
        contact: 'Зухурова Ганджина Тоджидиновна',
        datePatent: '15.10.2021',
        dateCheck: '15.01.2021',
        days: 2,
        subdivision: 'Оллила'
    },
    {
        contact: 'Исматова Шохиста Шухратовна',
        datePatent: '27.08.2021',
        dateCheck: '27.01.2021',
        days: 14,
        subdivision: 'Арома-Клининг'
    },
    {
        contact: 'Каххорова Мукаддам Бахтиёровна',
        datePatent: '23.10.2021',
        dateCheck: '23.01.2021',
        days: 10,
        subdivision: 'Арома-Клининг'
    },
    {
        contact: 'Курамбаев Хайдарбек Умарджон Угли',
        datePatent: '21.06.2021',
        dateCheck: '21.01.2021',
        days: 8,
        subdivision: 'ПерсоналСервис'
    },
    {
        contact: 'Курбонов Давронбек Фрунзаевич',
        datePatent: '14.02.2021',
        dateCheck: '14.01.2021',
        days: 1,
        subdivision: 'ПерсоналСервис'
    }
]
let negative_list = [
    {
        contact: 'Абдухалилов Сардор Равшан',
        dateCheck: '31.12.2020',
        days: -13,
        subdivision: 'Чабыкин ИП'
    },
    {
        contact: 'Азизов Ахлиддин Валиевич',
        dateCheck: '01.01.2021',
        days: -12,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Азимов Махаммаджон Исмоилджон Угли',
        dateCheck: '30.10.2020',
        days: -75,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Азимов Орифджон Одилджон Угли',
        datePatent: '08.11.2020',
        dateCheck: '08.10.2020',
        days: -97,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Алиджонов Хаётбек Кахрамон Угли',
        dateCheck: '07.12.2020',
        days: -37,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Атаджанов Гайрат Аминович',
        dateCheck: '04.01.2021',
        days: -9,
        subdivision: 'ВентКондиционерСервис'
    },
    {
        contact: 'Ахмедов Иброхимжон Солиевич',
        dateCheck: '23.10.2020',
        days: -82,
        subdivision: 'Подольск'
    },
    {
        contact: 'Ачилов Илхом Маруфович',
        dateCheck: '12.01.2021',
        days: -1,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Бахриев Собирджон Сохибович',
        dateCheck: '07.12.2020',
        days: -37,
        subdivision: 'Трайнет Ольгино'
    },
    {
        contact: 'Бобоев Сафармад Авалбоевич',
        dateCheck: '06.01.2021',
        days: -7,
        subdivision: 'Фильтровальные материалы'
    },
    {
        contact: 'Гулов Джалолидин Рахмоналиевич',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Джумакулова Азиза Хамро Кизи',
        dateCheck: '26.11.2020',
        days: -48,
        subdivision: 'Фрегат'
    },
    {
        contact: 'Джумамуратов Джавланбек Алимбаевич',
        dateCheck: '03.01.2021',
        days: -10,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Джуматов Мансур Махмудович',
        dateCheck: '14.12.2020',
        days: -30,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Ибрагимов Комилджон Шухратджонович',
        dateCheck: '28.10.2020',
        days: -77,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Икромов Давлатджон Хайрулло Угли',
        dateCheck: '22.11.2020',
        days: -52,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Каримов Сарварбек Саттор Угли',
        dateCheck: '13.11.2020',
        days: -61,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Кенджаева Шоира Сапарбоевна',
        dateCheck: '27.12.2020',
        days: -17,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Косимджонов Абдухошим Азамджон Угли',
        dateCheck: '09.12.2020',
        days: -35,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Мардонов Муминджон Зокирович',
        dateCheck: '08.01.2021',
        days: -5,
        subdivision: 'Эдельвейс'
    },
    {
        contact: 'Маткаримова Саида Кушназаровна',
        dateCheck: '07.01.2021',
        days: -6,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Махмадалиев Мухаммадали Ятимович',
        dateCheck: '07.01.2021',
        days: -6,
        subdivision: 'Полячков ИП'
    },
    {
        contact: 'Махматов Гофир Бекмурод Угли',
        dateCheck: '13.12.2020',
        days: -31,
        subdivision: 'ВентКондиционерСервис'
    },
    {
        contact: 'Махмудов Неъматилло Рахматилло Угли',
        datePatent: '17.12.2020',
        dateCheck: '17.11.2020',
        days: -57,
        subdivision: 'Подольск'
    },
    {
        contact: 'Мирзарахимов Музаффар Бегмурадович',
        dateCheck: '04.01.2021',
        days: -9,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Мусинов Фазлиддин Фахриддин Угли',
        dateCheck: '16.10.2020',
        days: -89,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Мусурмонов Зухриддин Зафарович',
        dateCheck: '06.01.2021',
        days: -7,
        subdivision: 'СоюзХимИнвест'
    },
    {
        contact: 'Негматова Гуландон Анваровна',
        dateCheck: '06.01.2021',
        days: -7,
        subdivision: 'Фрегат'
    },
    {
        contact: 'Нематов Фаррухджон Шарифджонович',
        dateCheck: '03.01.2021',
        days: -10,
        subdivision: 'РЖЕВКА-ХЛЕБ'
    },
    {
        contact: 'Расулов Мухаммадсодик Махматджонович',
        dateCheck: '09.01.2021',
        days: -4,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Саидкамолов Шерзод Абдикахорович',
        dateCheck: '21.11.2020',
        days: -53,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Сатторов Наим Валиевич',
        dateCheck: '31.12.2020',
        days: -13,
        subdivision: 'Авиатор-2'
    },
    {
        contact: 'Собитов Отабек Алижон Угли',
        dateCheck: '01.11.2020',
        days: -73,
        subdivision: 'Подольск'
    },
    {
        contact: 'Солиева Нозимахон Хамидулло Кизи',
        dateCheck: '12.01.2021',
        days: -1,
        subdivision: 'СоюзХимИнвест'
    },
    {
        contact: 'Сохибов Муродил Мухаммадали Угли',
        dateCheck: '27.12.2020',
        days: -17,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Толибов Абдукахор Абдуразокович',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Тураев Ботир Суюнович',
        dateCheck: '05.01.2021',
        days: -8,
        subdivision: 'РЖЕВКА-ХЛЕБ'
    },
    {
        contact: 'Тухтамишев Бехзод Шавкатович',
        datePatent: '17.12.2020',
        dateCheck: '17.12.2020',
        days: -27,
        subdivision: 'Оборудование для торговли'
    },
    {
        contact: 'Умурзаков Хасанбой Арапжон Угли',
        dateCheck: '15.11.2020',
        days: -59,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Уринбаев Азизбек Кадамбой Угли',
        dateCheck: '09.12.2020',
        days: -35,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Хабибуллаев Отабек Кудратулло Угли',
        dateCheck: '07.10.2020',
        days: -98,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Хакимов Сохибжон Соибжон Угли',
        dateCheck: '23.10.2020',
        days: -82,
        subdivision: 'Подольск'
    },
    {
        contact: 'Халилова Дилдорахон Баходировна',
        dateCheck: '04.01.2021',
        days: -9,
        subdivision: 'ЛВР АС'
    },
    {
        contact: 'Халматджанов Дилмуратджон',
        dateCheck: '25.11.2020',
        days: -49,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Хамидов Умид Хусанбоевич',
        dateCheck: '26.11.2020',
        days: -48,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Хасанбоев Амирулло Омонжон Угли',
        datePatent: '13.01.2021',
        dateCheck: '13.11.2020',
        days: -61,
        subdivision: 'Подольск'
    },
    {
        contact: 'Хасанов Махмуд Лолаевич',
        dateCheck: '12.01.2021',
        days: -1,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Хатамов Сардорбек Азимджон Угли',
        dateCheck: '06.10.2020',
        days: -99,
        subdivision: 'Трайнет СПБ'
    },
    {
        contact: 'Худоёров Сардор Рустам Угли',
        dateCheck: '19.11.2020',
        days: -55,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Шаймуродов Ислом Чориёр Угли',
        dateCheck: '09.11.2020',
        days: -65,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эркаева Мухиба Мухторовна',
        dateCheck: '20.10.2020',
        days: -85,
        subdivision: 'РЖЕВКА-ХЛЕБ'
    },
    {
        contact: 'Эркаева Шакаржон Шоназар Кизи',
        dateCheck: '18.11.2020',
        days: -56,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эшкурбонов Хуррам Норбоевич',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эшметов Руслон Куролбоевич',
        dateCheck: '08.01.2021',
        days: -5,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Эшмуродова Шахноза Бахтиёр Кизи',
        dateCheck: '02.01.2021',
        days: -11,
        subdivision: 'СоюзХимИнвест'
    }
]
let google_sheets_value = [
    ["Арома-Клининг", "hr@aroma-cleaning.ru"],
    ["ПерсоналСервис", "hr@aroma-cleaning.ru"],
    ["Сапига ИП", "hr@aroma-cleaning.ru"],
    ["Шпунюк ИП", "hr@aroma-cleaning.ru"],
    ["Оллила", "vitaly.k@guestworkers.ru"],
    ["Бочок ИП", "arsentevao@forte.su"],
    ["Кизимов ИП", "hr@aroma-cleaning.ru"],
    ["Трайнет СПБ", "komiljon.ibragimov@mail.ru"],
    ["Подольск", "nikolasha-3@mail.ru"],
    ["НПФ Электрик", "babelov@mail.ru"],
    ["Центргаз", "otdkadr@skand.ru"],
    ["ИП Шипулин", "minyaeva.viktoriya@yandex.ru"],
    ["Оллила", "vitaly.k@guestworkers.ru"],
    ["ИП Киселёв", "minyaeva.viktoriya@yandex.ru"],
    ["ИП Кошелев", "minyaeva.viktoriya@yandex.ru"],
    ["ИП Дегтярь", "minyaeva.viktoriya@yandex.ru"],
    ["ИП Полячков", "zhenchik@yandex.ru"],
    ["ИП Чабыкин", "minyaeva.viktoriya@yandex.ru"],
    ["ПЕТРОМЕДЛАБ", "komotdekapital@gmail.com"],
    ["НПФ Анлес", "ask@anles.ru"],
    ["АрчГрупп", "archgroup24@gmail.com"],
    ["Тепловое оборудование", "smirnova.o@guestworkers.ru"],
    ["Авиатор-2", "helenspb@gmail.com"],
    ["ЛД-ПРИНТ", "smokrikova@ldprint.ru"],
    ["СоюзХимИнвест", "hr@aroma-cleaning.ru"],
    ["Эдельвейс", "ilyosbek.xamrakulov@mail.ru"],
    ["ВентКондиционерСервис", "ventkonservice@mail.ru"],
    ["Финфлекс", "elena@finfleks.ru"],
    ["Оборудование для торговли", "odt@odt.ru"],
    ["ПромДетальМаш", "evd01@yandex.ru"],
    ["ПТ ГРУПП", "kudrina@trak-on.ru"],
    ["Бетокон", "shkelev@bk.ru"],
    ["Браво", "lucysarc@mail.ru"],
    ["ЛВР СК", "ep2@lvr-service.ru"],
    ["Окна Форте", "arsentevao@forte.su"],
    ["ЛВР АС", "ep2@lvr-service.ru"],
    ["Вентура", "kudrina@trak-on.ru"],
    ["Мистер ЛиС", "lisbrewbuh@mail.ru, lelikpo@yandex.ru"],
    ["Трайнет Ольгино", "avk0570@yandex.ru"],
    ["Фрегат", "19731703@mail.ru"],
    ["Рускодом Мебель", "ruskodom@mail.ru"],
    ["Лайф", "ilyosbek.xamrakulov@mail.ru"],
    ["РЖЕВКА-ХЛЕБ", "smirnova.o@guestworkers.ru"],
    ["Камышовая 38", "helenspb@gmail.com"],
    ["Ультра-Сервис", "komiljon.ibragimov@mail.ru"],
    ["Фильтровальные материалы", "doroshencoo@mail.ru"]
]
let email_content = [];
let email_address = [];
let test_list = [
    {
        contact: 'Алиджонов Лочинбек Ахмаджон Угли',
        datePatent: '14.02.2021',
        dateCheck: '14.02.2021',
        days: 32,
        subdivision: 'Арч Групп'
    },
    {
        contact: 'Додарджонов Мухиддин Хошимджонович',
        datePatent: '08.03.2021',
        dateCheck: '08.03.2021',
        days: 54,
        subdivision: 'ЛД-ПРИНТ'
    },
    {
        contact: 'Имомбердиев Тухтасин',
        datePatent: '09.03.2021',
        dateCheck: '09.03.2021',
        days: 55,
        subdivision: 'Оллила'
    },
    {
        contact: 'Кабулова Санобар Абдиджапаровна',
        datePatent: '03.02.2021',
        dateCheck: '03.02.2021',
        days: 21,
        subdivision: 'Браво'
    },
    {
        contact: 'Мухаматкулов Фарход Абдурахмонович',
        datePatent: '28.02.2021',
        dateCheck: '28.02.2021',
        days: 46,
        subdivision: 'ЛВР СК'
    },
    {
        contact: 'Насибджонов Махмуджон Абдумухтор Угли',
        datePatent: '12.02.2021',
        dateCheck: '12.02.2021',
        days: 30,
        subdivision: 'Эдельвейс'
    },
    {
        contact: 'Хайотов Эмомназар Махмадович',
        datePatent: '24.02.2021',
        dateCheck: '24.02.2021',
        days: 42,
        subdivision: 'Окна Форте'
    },
    {
        contact: 'Худойкулова Шоиста Рузикуловна',
        datePatent: '02.02.2021',
        dateCheck: '02.02.2021',
        days: 20,
        subdivision: 'ЛД-ПРИНТ'
    }
];


const google_sheets_values_email = [
    ["hr@aroma-cleaning.ru"],
    ["vitaly.k@guestworkers.ru"],
    ["arsentevao@forte.su"],
    ["komiljon.ibragimov@mail.ru"],
    ["nikolasha-3@mail.ru"],
    ["babelov@mail.ru"],
    ["otdkadr@skand.ru"],
    ["minyaeva.viktoriya@yandex.ru"],
    ["zhenchik@yandex.ru"],
    ["komotdekapital@gmail.com"],
    ["ask@anles.ru"],
    ["archgroup24@gmail.com"],
    ["smirnova.o@guestworkers.ru"],
    ["helenspb@gmail.com"],
    ["ilyosbek.xamrakulov@mail.ru"],
    ["ventkonservice@mail.ru"],
    ["elena@finfleks.ru"],
    ["odt@odt.ru"],
    ["evd01@yandex.ru"],
    ["kudrina@trak-on.ru"],
    ["shkelev@bk.ru"],
    ["lucysarc@mail.ru"],
    ["ep2@lvr-service.ru"],
    ["lisbrewbuh@mail.ru"],
    ["avk0570@yandex.ru"],
    ["19731703@mail.ru"],
    ["ruskodom@mail.ru"],
    ["doroshencoo@mail.ru"]
]

const emailsMap = Object.fromEntries(google_sheets_value);

// Создание массива где присваиваетсяя один электронный адрес для парных подразделений
const a = debtor_list.map(x => ({
    ...x,
    email: emailsMap[x.subdivision]
}));

const b = negative_list.map(x => ({
    ...x,
    email: emailsMap[x.subdivision]
}));
const c = test_list.map(x => ({
    ...x,
    email: emailsMap[x.subdivision]
}));


// Группировка
function groupBy(list, keyGetter) {
    const map = new Map();
    list.forEach((item) => {
        const key = keyGetter(item);
        const collection = map.get(key);
        if (!collection) {
            map.set(key, [item]);
        } else {
            collection.push(item);

        }
    });
    return map;
}


const grouped = groupBy(a, pet => pet.email);
const negativegroup = groupBy(b, pet => pet.email);
const testGroup = groupBy(c, pet => pet.email);

// Создание тела письма
google_sheets_values_email.forEach(e => {
    const cur = grouped.get(e[0]);
    const neg = negativegroup.get(e[0]);
    const test = testGroup.get(e[0]);
    const cur_content = [];
    const neg_content = [];
    const test_content = [];
    if (!cur) {
        //   console.log(`По почте ${e[0]} никого нет <br />`)
        return
    } else  {
        email_address.push(`${e}`);
        cur_content.push(
            `
    <div style="
    font-size: 15px;
    line-height: 1.5">
    <p style="
    font-size: 18px">Доброе время суток!</p> <br>

Напоминаем нашим клиентам о необходимости актуализации информации по оплате патентов. <br>
Все сотрудники, у кого не будет актуальных документов будут отстранены, а заработная плата не будет начисляться и выплачиваться. <br>
Убедительна просьба присылать актуальную информацию до 13го (для начисления аванса) и 28го (для начисления заработной платы) чисел каждого месяца.
 <br>
Так же, при необходимости трудоустройства новых сотрудников и предоставлении их документов по электронной почте, просим в теле письма писать следующую фразу: "Просим трудоустроить сотрудника ФИО" с указанием даты трудоустройства. <br>
Ниже представлена таблица с актуальными данными: <br>
    </div>
    <table style="
    text-align: center;
    border-collapse: collapse;
    width: 100%;
    font-size: 13px;
    ">
    <tr style="
    border: 1px solid #000000">
    <td style="
        text-align: left">ФИО сотрудника</td>
    <td> Патент действителен до</td>
<td>Патент оплачен до</td>
<td>Количество дней<div>до истечения оплаты</td>
</tr>
    ${cur.map(c=>`
    <tr style="
    border: 1px solid #000000">
        <td style="
        text-align: left">
        ${c.contact}
        </td>
        <td>${c.datePatent}</td>
        <td>${c.dateCheck}</td>
        <td>${c.days}</td>
    </tr>`).join("")}
    </table>
           `);
        if (neg) {
            neg_content.push(
                `
                <p style="
    color: red;
    font-size: 17px;
    ">Список работников, у которых были просрочены чеки:
    </p>
     <table style="
    text-align: center;
    border-collapse: collapse;
    width: 100%;
    font-size: 13px;
    ">
    <tr style="
    border: 1px solid #000000">
    <td style="
        text-align: left">ФИО сотрудника</td>
<td>Патент оплачен до</td>
<td>Количество дней<div>с момента просрочки</td>
</tr>
     ${neg.map(c=>`
    <tr style="
    border: 1px solid #000000">
        <td style="
        text-align: left">
        ${c.contact}
        </td>
        <td>${c.dateCheck}</td>
        <td>${c.days}</td>
    </tr>`).join("")}
    </table>
                `
            )
        }
        if (test) {
            test_content.push(
                `
                <p style="
    color: red;
    font-size: 17px;
    ">Список работников, которым необходимо переоформить патент</p>
     <table style="
    text-align: center;
    border-collapse: collapse;
    width: 100%;
    font-size: 13px;
    ">
    <tr style="
    border: 1px solid #000000">
    <td style="
        text-align: left">ФИО сотрудника</td>
<td>Патент действителен до</td>
<td>Количество дней<div>до окончания патента</td>
</tr>
      ${test.map(c=>`
    <tr style="
    border: 1px solid #000000">
        <td style="
        text-align: left">
        ${c.contact}
        </td>
        <td>${c.dateCheck}</td>
        <td>${c.days}</td>
    </tr>`).join("")}
    </table>
                `
            )
        }
    }
    const email_list = cur_content + neg_content + test_content;
    email_content.push(email_list)
});
console.log(email_content);
document.write(email_content);
